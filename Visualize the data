import plotly.graph_objects as go

# 2. Create a figure object
fig = go.Figure()

# 3. Add a candlestick trace
fig.add_trace(go.Candlestick(x=df.index,
                open=df['open'],
                high=df['high'],
                low=df['low'],
                close=df['close'],
                name='Candlestick'))

# 4. Add a line trace for the moving average
fig.add_trace(go.Scatter(x=df.index,
                         y=df['moving_average'],
                         mode='lines',
                         name='Moving Average'))

# 5. Update the layout of the figure
fig.update_layout(
    title='Stock Price with Moving Average',
    xaxis_title='Timestamp',
    yaxis_title='Price',
    xaxis_rangeslider_visible=False # Hide the range slider for better readability
)

# 6. Display the figure
fig.show()
